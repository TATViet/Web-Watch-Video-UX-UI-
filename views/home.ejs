<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>OwlLoop ‚Äî Home</title>

<style>
:root{
  --mobile-w:420px;
  --bg:#1f3326;
  --card:#2a4031;
  --muted:#b7c7bc;
  --accent:#88c273;
  --accent-2:#a6d39b;
  --radius:14px;
  font-family: Inter, system-ui, Arial;
}

*{box-sizing:border-box}

body{
  margin:0;
  background:#111;
  color:#fff;
  display:flex;
  justify-content:center;
}

.container{
  width:100%;
  max-width:var(--mobile-w);
  min-height:100vh;
  padding:14px;
  background:var(--bg);
}

/* ===== ICON SYSTEM ===== */
.icon{
  width:20px;
  height:20px;
  stroke:#fff;
  stroke-width:2;
  fill:none;
}

.icon-btn{
  height:36px;
  padding:0 10px;
  border-radius:10px;
  background:rgba(255,255,255,.08);
  display:flex;
  align-items:center;
  gap:6px;
  font-size:13px;
}

/* ===== HEADER ===== */
header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  margin-bottom:16px;
}

/* LOGO: full green */
.logo{
  width:44px;
  height:44px;
  border-radius:14px;
  background:linear-gradient(135deg,var(--accent),var(--accent-2));
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:22px;
}

/* ===== FEATURED ===== */
.featured{
  background:var(--card);
  padding:14px;
  border-radius:var(--radius);
}

.video-title{
  font-weight:700;
  font-size:15px;
}

.video-meta{
  font-size:12px;
  color:var(--muted);
  margin-top:2px;
}

.video-thumb{
  margin-top:10px;
  position:relative;
  aspect-ratio:16/9;
  border-radius:12px;
  overflow:hidden;
  cursor:pointer;
}

.video-thumb img{
  width:100%;
  height:100%;
  object-fit:cover;
  opacity:.85;
}

.play-btn{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
}

.play-btn div{
  width:54px;
  height:54px;
  border-radius:50%;
  background:rgba(0,0,0,.6);
  display:flex;
  align-items:center;
  justify-content:center;
}

.play-btn svg{
  width:26px;
  height:26px;
  fill:#fff;
}

.video-info{
  margin-top:8px;
  font-size:13px;
  color:var(--muted);
}

/* ===== SECTION TITLE ===== */
.section-title{
  margin:16px 0 8px;
  font-size:14px;
  font-weight:700;
}

/* ===== USER TOPICS (NO SCROLL) ===== */
.topics-static{
  display:flex;
  gap:10px;
}

.topic{
  padding:8px 14px;
  border-radius:999px;
  background:rgba(255,255,255,.08);
  font-size:13px;
}

.topic.more{
  font-weight:700;
  cursor:pointer;
}

/* ===== CONTINUE ===== */
.continue{
  background:var(--card);
  border-radius:var(--radius);
  padding:14px;
  margin-top:16px;
}

.continue-item{
  display:flex;
  gap:12px;
  margin-bottom:12px;
  cursor:pointer;
  align-items: flex-start; /* Align top ƒë·ªÉ text d√†i kh√¥ng ·∫£nh h∆∞·ªüng thumbnail */
}

.thumb{
  width:96px;
  height:54px;
  border-radius:8px;
  overflow:hidden;
  position:relative;
  flex-shrink: 0; /* NgƒÉn thumbnail b·ªã co l·∫°i */
}

.thumb img{
  width:100%;
  height:100%;
  object-fit:cover;
}

.continue-info {
  flex: 1; /* Chi·∫øm h·∫øt kh√¥ng gian c√≤n l·∫°i */
  min-width: 0; /* Cho ph√©p co l·∫°i n·∫øu c·∫ßn */
}

.continue-title{
  font-size:14px;
  font-weight:600;
  overflow: hidden; /* ·∫®n text tr√†n */
  text-overflow: ellipsis; /* Th√™m d·∫•u ... n·∫øu d√†i */
  display: -webkit-box;
  -webkit-line-clamp: 2; /* Gi·ªõi h·∫°n 2 d√≤ng */
  -webkit-box-orient: vertical;
  line-height: 1.2; /* ƒêi·ªÅu ch·ªânh line height */
}

.continue-meta{
  font-size:12px;
  color:var(--muted);
  white-space: nowrap; /* Kh√¥ng wrap meta */
  overflow: hidden;
  text-overflow: ellipsis;
}

/* ===== MODAL ===== */
.modal-overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:100;
}

.modal-overlay.show{
  display:flex;
}

.modal{
  width:90%;
  max-width:360px;
  background:var(--card);
  border-radius:16px;
  padding:14px;
}

.modal-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:10px;
}

.close{
  cursor:pointer;
  opacity:.7;
}

.search{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:none;
  background:#1f3326;
  color:#fff;
  margin-bottom:10px;
}

.sort{
  display:flex;
  gap:8px;
}

.sort button{
  flex:1;
  padding:8px 0;
  border-radius:10px;
  border:none;
  background:rgba(255,255,255,.06);
  color:#fff;
  font-size:13px;
}

.sort button.active{
  background:var(--accent);
  color:#123;
  font-weight:600;
}

.tag-list{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  padding-top:6px;
  border-top:1px solid rgba(255,255,255,.08);
}

.tag{
  padding:8px 12px;
  border-radius:999px;
  background:rgba(255,255,255,.08);
  font-size:13px;
  cursor:pointer;
}

.sort-wrapper{
  margin-bottom:12px;
}

.sort-label{
  font-size:12px;
  color:var(--muted);
  margin-bottom:6px;
}
</style>
</head>

<body>
<div class="container">


    <header>
  <div class="logo" onclick="location.href='/'" style="cursor:pointer;">ü¶â</div>

  <div style="display:flex; gap:8px;">
    <% if (!user) { %>
      <div class="icon-btn" onclick="location.href='/login'">
        <svg class="icon" viewBox="0 0 24 24">
          <circle cx="12" cy="8" r="4"/>
          <path d="M4 20c0-4 4-6 8-6s8 2 8 6"/>
        </svg>
        Login
      </div>
    <% } else { %>
      <div class="icon-btn" onclick="location.href='/account'">
        <svg class="icon" viewBox="0 0 24 24">
          <circle cx="12" cy="8" r="4"/>
          <path d="M4 20c0-4 4-6 8-6s8 2 8 6"/>
        </svg>
        <%= user.name %>
      </div>
    <% } %>

    <div class="icon-btn">
      <svg class="icon" viewBox="0 0 24 24">
        <path d="M4 4h16v16H4z"/>
        <path d="M4 6l8 6 8-6"/>
      </svg>
    </div>

    <div class="icon-btn">
      <svg class="icon" viewBox="0 0 24 24">
        <circle cx="11" cy="11" r="7"/>
        <line x1="21" y1="21" x2="16.5" y2="16.5"/>
      </svg>
    </div>
  </div>
</header>

<section class="featured">
  <div class="video-title">√ù nghƒ©a c·ªßa h·∫°nh ph√∫c</div>
  <div class="video-meta">Tri Th·ª©c M·ªü R·ªông ‚Ä¢ 32 ph√∫t</div>

  <div class="video-thumb" onclick="location.href='watch.html'">
    <img src="https://img.youtube.com/vi/SJF2ph3JWsE/hqdefault.jpg">
    <div class="play-btn">
      <div>
        <svg viewBox="0 0 24 24">
          <polygon points="8,5 19,12 8,19"/>
        </svg>
      </div>
    </div>
  </div>

  <div class="video-info">
    Ki·∫øn th·ª©c ‚Ä¢ Ki·∫øn th·ª©c vui ‚Ä¢ 32:10
  </div>
</section>

<div class="section-title">Topics You Watch</div>
<section class="topics-static">
  <div class="topic" onclick="location.href='/topic/knowledge'">Knowledge</div>
  <div class="topic" onclick="location.href='/topic/podcast'">Podcast</div>
  <div class="topic" onclick="location.href='/topic/asmr'">ASMR</div>
  <div class="topic more" onclick="openTopicModal()">‚Ä¶</div>
</section>

<section class="continue">
  <div class="section-title">Continue video</div>

  <% if (videos && videos.length > 0) { %>
    <% videos.forEach(video => { %>
      <% 
        // Extract VIDEO_ID t·ª´ URL
        let videoId = '';
        if (video.url.includes('youtube.com/watch?v=')) {
          videoId = video.url.split('v=')[1].split('&')[0]; // L·∫•y ID t·ª´ full URL
        } else if (video.url.includes('youtu.be/')) {
          videoId = video.url.split('youtu.be/')[1].split('?')[0]; // L·∫•y ID t·ª´ short URL
        }
        const thumbnailUrl = videoId ? `https://img.youtube.com/vi/${videoId}/hqdefault.jpg` : 'https://via.placeholder.com/96x54?text=No+Thumb'; // Placeholder n·∫øu kh√¥ng c√≥
      %>
      <div class="continue-item" onclick="location.href='/watch?v=<%= encodeURIComponent(video.url) %>'">
        <div class="thumb">
          <img src="<%= thumbnailUrl %>" alt="<%= video.title %>">
        </div>
        <div class="continue-info">
          <div class="continue-title"><%= video.title %></div>
          <div class="continue-meta"><%= video.duration %> ‚Ä¢ <%= video.channel || 'Unknown' %></div>
        </div>
      </div>
    <% }); %>
  <% } else { %>
    <p>No videos available to continue.</p>
  <% } %>
</section>

</div>

<!-- MODAL -->
<div class="modal-overlay" id="topicModal">
  <div class="modal">

    <!-- TITLE -->
    <div class="modal-header">
      <strong>Ch·ªçn ch·ªß ƒë·ªÅ</strong>
      <span class="close" onclick="closeTopicModal()">‚úï</span>
    </div>

    <!-- SEARCH -->
    <input class="search" placeholder="T√¨m ch·ªß ƒë·ªÅ...">

    <!-- SORT MODE -->
    <div class="sort-wrapper">
      <div class="sort-label">S·∫Øp x·∫øp theo</div>
      <div class="sort">
        <button class="active">G·∫ßn ƒë√¢y</button>
        <button>Y√™u th√≠ch</button>
        <button>Trending</button>
      </div>
    </div>

    <!-- TOPIC LIST -->
  <div class="tag-list">
  <div class="tag" onclick="location.href='/topic/knowledge'">Knowledge</div>
  <div class="tag" onclick="location.href='/topic/podcast'">Podcast</div>
  <div class="tag" onclick="location.href='/topic/asmr'">ASMR</div>

  <!-- Ch∆∞a c√≥ -->
  <div class="tag" onclick="location.href='/topic/developphase'">Philosophy</div>
  <div class="tag" onclick="location.href='/topic/developphase'">Science</div>
  <div class="tag" onclick="location.href='/topic/developphase'">Meditation</div>
  <div class="tag" onclick="location.href='/topic/developphase'">Self-help</div>
</div>


  </div>
</div>


<script>
function openTopicModal(){
  document.getElementById("topicModal").classList.add("show");
}
function closeTopicModal(){
  document.getElementById("topicModal").classList.remove("show");
}
</script>

</body>
</html>